<input type="checkbox" id="toggle-darkmode" />
<label for="toggle-darkmode"><span>Toggle Light/Dark Mode</span></label>

<script>
  const checkbox = document.getElementById('toggle-darkmode')
  const LOCAL_STORAGE_KEY = 'color-mode'
  const ATTRIBUTE_KEY = 'data-theme'

  const setColorMode = (mode) => {
    document.documentElement.setAttribute(ATTRIBUTE_KEY, mode)
    window.localStorage.setItem(LOCAL_STORAGE_KEY, mode)
  }

  checkbox.addEventListener('click', () => {
    const wasDark = document.documentElement.getAttribute(ATTRIBUTE_KEY) === 'dark'
    setColorMode(wasDark ? 'light' : 'dark')
  })

  const mediaQuery = window.matchMedia('(prefers-color-scheme: dark)')
  const defaultState =
    window.localStorage.getItem(LOCAL_STORAGE_KEY) || (mediaQuery.matches ? 'dark' : 'light')
  setColorMode(defaultState)
</script>
